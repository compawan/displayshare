<!DOCTYPE html>
<html>
<head><title>ðŸ“º Receiver</title></head>
<body>
<h2>Live Screen Stream</h2>
<video id="video" autoplay playsinline style="width:100%;border:1px solid black"></video>
<script>
const video = document.getElementById("video");
const socket = new WebSocket("wss://displayshare.onrender.com");
const pc = new RTCPeerConnection({
  iceServers: [{ urls: "stun:stun.l.google.com:19302" }]
});

pc.onicecandidate = (event) => {
  if (event.candidate) {
    socket.send(JSON.stringify({ type: "candidate", candidate: event.candidate }));
  }
};

pc.ontrack = (event) => {
  console.log("âœ… Track received:", event.streams[0]);
  video.srcObject = event.streams[0];
};

socket.onmessage = async ({ data }) => {
  const msg = JSON.parse(data);
  if (msg.type === "offer") {
    await pc.setRemoteDescription(new RTCSessionDescription(msg));
    const answer = await pc.createAnswer();
    await pc.setLocalDescription(answer);
    socket.send(JSON.stringify({ type: "answer", sdp: pc.localDescription.sdp }));
  } else if (msg.type === "candidate") {
    await pc.addIceCandidate(new RTCIceCandidate(msg.candidate));
  }
};
</script>
</body>
</html>
